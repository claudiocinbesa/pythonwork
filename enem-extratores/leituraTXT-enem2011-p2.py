import csv
# converte TXT para CSV  (dados socioeconomicos ENEM 2011)
#fileOrig = 'D:\dct\enem-microdados\microdados_enem2011\Dados Enem 2011\DADOS_ENEM_2011.txt'
#fileTarg = 'D:\dct\enem-microdados\DADOS_ENEM_2011.csv'
path = 'D:/dct/enem-microdados'
arq = 'QUESTIONARIO_SOCIO_ECONOMICO_ENEM_2011'
fileOrig = path + '/microdados_enem2011/Dados/'+arq+'.txt'
fileTarg = path + '/microdados_enem2011/'+arq+'.csv'

f1 = open(fileOrig, 'r')
f2 = csv.writer(open(fileTarg, "wb"))
print ("gerando CSV de " + arq)

#grava o cabecalho
f2.writerow([ 
'NU_INSCRICAO',
'IN_QSE',
'Q01',
'Q02',
'Q03',
'Q04',
'Q05',
'Q06',
'Q07',
'Q08',
'Q09',
'Q10',
'Q11',
'Q12',
'Q13',
'Q14',
'Q15',
'Q16',
'Q17',
'Q18',
'Q19',
'Q20',
'Q21',
'Q22',
'Q23',
'Q24',
'Q25',
'Q26',
'Q27',
'Q28',
'Q29',
'Q30',
'Q31',
'Q32',
'Q33',
'Q34',
'Q35',
'Q36',
'Q37',
'Q38',
'Q39',
'Q40',
'Q41',
'Q42',
'Q43',
'Q44',
'Q45',
'Q46',
'Q47',
'Q48',
'Q49',
'Q50',
'Q51',
'Q52',
'Q53',
'Q54',
'Q55',
'Q56',
'Q57',
'Q58',
'Q59',
'Q60',
'Q61',
'Q62',
'Q63',
'Q64',
'Q65',
'Q66',
'Q67',
'Q68',
'Q69',
'Q70',
'Q71',
'Q72',
'Q73',
'Q74',
'Q75'
])
i = 0
while 1:
    line_text = f1.readline()
    if line_text == "":
        break
    else:
        # recupera as variaveis e        
        # grava dados em um CSV
        f2.writerow([  
            line_text[0:11 + 1].strip(), 
            line_text[12:12 + 1].strip(), 
            line_text[13:14 + 1].strip(), 
            line_text[15:15 + 1].strip(), 
            line_text[16:16 + 1].strip(), 
            line_text[17:17 + 1].strip(), 
            line_text[18:18 + 1].strip(), 
            line_text[19:19 + 1].strip(), 
            line_text[20:20 + 1].strip(), 
            line_text[21:21 + 1].strip(), 
            line_text[22:22 + 1].strip(), 
            line_text[23:23 + 1].strip(), 
            line_text[24:24 + 1].strip(), 
            line_text[25:25 + 1].strip(), 
            line_text[26:26 + 1].strip(), 
            line_text[27:27 + 1].strip(), 
            line_text[28:28 + 1].strip(), 
            line_text[29:29 + 1].strip(), 
            line_text[30:30 + 1].strip(), 
            line_text[31:31 + 1].strip(), 
            line_text[32:32 + 1].strip(), 
            line_text[33:33 + 1].strip(), 
            line_text[34:34 + 1].strip(), 
            line_text[35:35 + 1].strip(), 
            line_text[36:37 + 1].strip(), 
            line_text[38:38 + 1].strip(), 
            line_text[39:39 + 1].strip(), 
            line_text[40:40 + 1].strip(), 
            line_text[41:41 + 1].strip(), 
            line_text[42:42 + 1].strip(), 
            line_text[43:43 + 1].strip(), 
            line_text[44:44 + 1].strip(), 
            line_text[45:45 + 1].strip(), 
            line_text[46:46 + 1].strip(), 
            line_text[47:47 + 1].strip(), 
            line_text[48:48 + 1].strip(), 
            line_text[49:49 + 1].strip(), 
            line_text[50:50 + 1].strip(), 
            line_text[51:51 + 1].strip(), 
            line_text[52:52 + 1].strip(), 
            line_text[53:53 + 1].strip(), 
            line_text[54:54 + 1].strip(), 
            line_text[55:55 + 1].strip(), 
            line_text[56:56 + 1].strip(), 
            line_text[57:57 + 1].strip(), 
            line_text[58:58 + 1].strip(), 
            line_text[59:59 + 1].strip(), 
            line_text[60:60 + 1].strip(), 
            line_text[61:61 + 1].strip(), 
            line_text[62:62 + 1].strip(), 
            line_text[63:63 + 1].strip(), 
            line_text[64:64 + 1].strip(), 
            line_text[65:65 + 1].strip(), 
            line_text[66:66 + 1].strip(), 
            line_text[67:67 + 1].strip(), 
            line_text[68:68 + 1].strip(), 
            line_text[69:69 + 1].strip(), 
            line_text[70:70 + 1].strip(), 
            line_text[71:71 + 1].strip(), 
            line_text[72:72 + 1].strip(), 
            line_text[73:73 + 1].strip(), 
            line_text[74:74 + 1].strip(), 
            line_text[75:75 + 1].strip(), 
            line_text[76:76 + 1].strip(), 
            line_text[77:77 + 1].strip(), 
            line_text[78:78 + 1].strip(), 
            line_text[79:79 + 1].strip(), 
            line_text[80:80 + 1].strip(), 
            line_text[81:81 + 1].strip(), 
            line_text[82:82 + 1].strip(), 
            line_text[83:83 + 1].strip(), 
            line_text[84:84 + 1].strip(), 
            line_text[85:85 + 1].strip(), 
            line_text[86:86 + 1].strip(), 
            line_text[87:87 + 1].strip(), 
            line_text[88:88 + 1].strip(), 
            line_text[89:89 + 1].strip()
            ])             
    i = i + 1
    # if i > 5:
        # break

f1.close()

